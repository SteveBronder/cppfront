// AD rule for doubling - should be discoverable by @autodiff
ad_rule_double: type = {
    name: std::string = "double_it";
    n_args: int = 1;
    is_member: bool = false;

    forward: (x: double) -> double = x * 2.0;
    reverse: (res_val: double, res_adj: double,
              x_val: double, inout x_adj: double) = {
        x_adj += res_adj * 2.0;  // d/dx(2x) = 2
    }
}
